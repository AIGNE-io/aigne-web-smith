type: team
name: detailGeneratorAndTranslate
description: 生成文档详情并翻译
skills:
  - ./transform-detail-datasources.mjs
  - type: team
    task_render_mode: collapse
    name: detailGenerate
    skills:
      - url: ./find-user-preferences-by-path.mjs
        default_input:
          scope: document
      - ./content-detail-generator.yaml
      - type: transform
        jsonata: |
          $merge([
            $,
            { "reviewContent": content }
          ])
    reflection:
      reviewer: ./check-detail-result.mjs
      is_approved: isApproved
      max_iterations: 5
      return_last_on_max_iterations: true
    task_title: Generate detail for '{{ title }}'
  - type: transform
    task_render_mode: hide
    jsonata: |
      $merge([
        $,
        { "feedback": "" }
      ])
  - ./batch-translate.yaml
  - ./save-single-doc.mjs
input_schema:
  type: object
  properties:
    nodeName:
      type: string
      description: 节点名称
      default: Section
    locale:
      type: string
      description: 语言
    targetAudience:
      type: string
      description: 目标受众
    glossary:
      type: string
      description: 术语表
    doc-path:
      type: string
      description: 当前路径
    feedback:
      type: string
      description: 反馈
    sources:
      type: array
      items:
        type: string
        description: 源码路径
    sourcesPath:
      type: array
      items:
        type: string
        description: 源码路径
      default:
        - ./
    includePatterns:
      type: array
      items:
        type: string
        description: 包含的文件名
    excludePatterns:
      type: array
      items:
        type: string
        description: 排除的文件名
    outputDir:
      type: string
      description: 输出目录
      default: ./aigne-docs/output
    docsDir:
      type: string
      description: 文档目录
      default: ./aigne-docs/docs
    additionalInformation:
      type: string
      description: 额外补充信息
output_schema:
  type: object
  properties:
    title:
      type: string
    description:
      type: string
    path:
      type: string
    content:
      type: string
mode: sequential
