type: team
name: generateComponentLibrary
description: Analyze all page content to generate component library
skills:
  - type: ai
    name: generateComponentLibrary
    instructions:
      url: ../../../prompts/generate/component-library/generate-component-library.md
    output_schema:
      type: object
      properties:
        componentLibrary:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                description: Component name
              summary:
                type: string
                description: Component purpose and characteristics, as specific as possible. For composite components, layout features should be described
              type:
                type: string
                description: Component type, either "atomic" (atomic component) or "composite" (composite component)
              componentId:
                type: string
                description: Component ID (atomic components must use real ComponentId, composite components use randomly generated ID)
              fieldCombinations:
                type: array
                items:
                  type: string
                description: FieldCombinations handled by the component
              relatedComponents:
                type: array
                description: >
                  List of components related to this composite component.
                  Each item represents either:
                    1) An Atomic component mapping (with componentId and fieldCombinations), or
                    2) An independent array element (e.g., list.0, list.1) that may not have a componentId but has fieldCombinations for layout mapping.
                items:
                  type: object
                  properties:
                    componentId:
                      type: string
                      description: >
                        Optional. ID of the related atomic component. 
                        Can be omitted if the array element or fieldCombination does not directly match an existing atomic component.
                    fieldCombinations:
                      type: array
                      items:
                        type: string
                      description: >
                        Required. List of field names used by the related component or array element.
                        For array elements (e.g., list.0, list.1), this defines the fields to map to atomic components or for layout generation.
                  required:
                    - fieldCombinations
  - ./save-component-library.mjs
reflection:
  reviewer: ./validate-component-library.mjs
  is_approved: isApproved
  max_iterations: 3
  return_last_on_max_iterations: true
task_title: Generate component library
mode: sequential
