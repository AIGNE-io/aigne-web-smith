type: team
name: translate
description: Translate document content to selected languages
skills:
  - url: ./input-generator.mjs
    default_input:
      skipIfExists: true
  - ./load-config.mjs
  - ./load-sources.mjs
  - type: transform
    task_render_mode: hide
    jsonata: |
      $merge([
        $,
        {
          'structurePlan': originalStructurePlan,
          'structurePlanResult': $map(originalStructurePlan, function($item) {
            $merge([
              $item,
              {
                'translates': [$map(translateLanguages, function($lang) { {"language": $lang} })]
              }
            ])
          })
        }
      ])
  - url: ./find-items-by-paths.mjs
    default_input:
      isTranslate: true
  - ./language-selector.mjs
  - type: team
    name: batchDocsTranslate
    skills:
      - ./batch-translate.yaml
      - url: ./save-single-doc.mjs
        default_input:
          isTranslate: true
    iterate_on: selectedDocs
    concurrency: 3
  - url: ./check-feedback-refiner.mjs
    default_input:
      stage: translation_refine
  - url: ./action-success.mjs
    default_input:
      action: "Document translated"
input_schema:
  type: object
  properties:
    glossary:
      type: string
      description: Glossary of terms for consistent terminology, use @<file> to read from a file
    docs:
      type: array
      items:
        type: string
      description: Document paths to translate
    langs:
      type: array
      items:
        type: string
      description: "Languages to translate to, available languages are: en, zh, zh-TW, ja, fr, de, es, it, ru, ko, pt, ar"
    feedback:
      type: string
      description: Feedback for translation improvement
mode: sequential
